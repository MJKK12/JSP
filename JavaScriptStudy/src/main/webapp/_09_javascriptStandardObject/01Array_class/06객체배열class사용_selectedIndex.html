<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>class를 사용하여 객체를 만들고 select 태그를 이용해 선택한 인물의 이미지 및 정보가 화면에 나타나도록 한다</title>

<style type="text/css">

	div#container {
		width : 80%;
		margin : 0 auto;
	}

	div#person	{
		/* border : solid 1px red;	 */
		min-height: 50px;
		overflow: hidden;
		margin-top: 20px;
	}
	
	img {
		display: block;
		width: 15%;
		float: left;
	}
	
	div#information {
		/* border : solid 1px blue; */
		width: 40%;
		float: left; 
	}
	
	ul {
		/* border: solid 1px gray; */
		list-style-type: none;
		padding: 0px;
		margin: 0 0 0 2%;
	}
	
	li {
		line-height: 35px;
	}
	
	label {
		display: inline-block;	
		width: 20%;
		font-weight: bold;
		color: blue;
	}
	
	select {
		height: 30px;
	}
	
</style>

<script type="text/javascript">
	
	window.onload = function() {
		
		// ES6(ECMAScript6) 에서 나온 class 를 사용하여 객체를 생성해 봅니다.
		
		// JavaScript Classes 는 ES6(ECMAScript 6) 이다.
		   /*
		      >> 문법 << 
		      class ClassName {
		         
		         속성명 = 초기값;
		         
		         constructor() { ... }
		         
		         set xxx(value) {  // 세터
		            this.속성명 = value;
		         }
		         
		         get xxx() { return this.속성명; }  // 게터
		         
		         method_1() { ... }
		         method_2() { ... }
		         method_3() { ... }
		      }
		   */
		
		class Member {
			
			// birthYear = 0;		// birthYear 의 접근제한자는 public 이며, class 외부에서도 접근이 가능하다.
		   							// birthYear 의 초기값을 0으로 주면서 Number 타입으로 한다.  
			   #birthYear = 0;		// birthYear 의 접근제한자는 private 이며, class 내부에서만 접근이 가능하다.
		   							// 접근제한자 private 은 속성(프로퍼티)명 앞에 #을 붙인다.
		   	
			// 생성자 함수   
			constructor(name, photo, address, special) {  	// 객체를 만든다.
				this.name = name;	// this(Member) 클래스에는 name 속성값이 있는데, 여기에 name 을 넣어주겠다.
				this.photo = photo;
			//	this.birthYear = birthYear;	 → 접근제한자를 public으로 주어 위로 보낸다.
				this.address = address;
				this.special = special;
			}
			
			set setBirthYear(value) {
				if(value <= 0) throw new Error("생년은 음수가 될 수 없습니다.");	/* 사용자가 정의하는 오류를 발생시킨다. F12 console 창에 오류메시지가 나타난다. */
				this.#birthYear = value;
			}   
			
			get getBirthYear() {
				return this.#birthYear;
			}
			   
			// 메소드 (현재년도-태어난년도+1 를 age 로 return 하겠다.)
			age() {	
				const date = new Date();					// 자바스크립트에서의 현재 날짜,시간을 알려주는 것이다.
				return date.getFullYear() - this.#birthYear + 1;	// date.getFullYear() 이 date 에서 년도만 추출해오는 것이다.
			}
			   
		}// end of class Member---------------------------------
		   
		const iyou_mbr = new Member("아이유","iyou.jpg","서울시 마포구","가수 겸 배우 팬이 많음");		
	//	iyou_mbr.birthYear = -1995;		// birthYear 는 public 이므로 외부에서 직접적으로 접근이 가능하다. 그러므로 생년에 음수도 입력이 가능하다.
		
	//	iyou_mbr.#birthYear = 1995;		// #birthYear 는 private 이므로 외부에서 직접적으로 접근이 불가하다.
	// Uncaught SyntaxError: Private field '#birthYear' must be declared in an enclosing class
	// 만약, 생년을 -1900 이라고 적는다면, 2022-(-1900) + 1 생년에 -는 없으므로 막아줘야 한다.
		
	//	iyou_mbr.setBirthYear = -1995;	// 세터(Setter)를 호출함.
										// 주의사항 : iyou_mbr.setBirthYear(-1995); 와 같이 하면 오류이다.
		// Uncaught Error: 생년은 음수가 될 수 없습니다.

		iyou_mbr.setBirthYear = 1995; 	// 세터(Setter)를 호출함.
										// 주의사항 : iyou_mbr.setBirthYear(-1995); 와 같이 하면 오류이다.
		
	//	console.log(iyou_mbr.age());
		
		const kimth_mbr = new Member("김태희","kimth.jpg","서울시 강서구","배우 팬이 많음");		
		kimth_mbr.setBirthYear = 1996; // 세터를 호출함
										
		const parkby_mbr = new Member("박보영","parkby.jpg","서울시 강남구","배우 겸 가수 팬이 많음");		
		parkby_mbr.setBirthYear = 1997; // 세터를 호출함
	
		const arrMember = [];	// 또는 const arrMember = new Array();
		arrMember.push(iyou_mbr);
		arrMember.push(kimth_mbr);
		arrMember.push(parkby_mbr);
		
		////////////////////////////////////////////////////////////////////////////////////
	
		const person = document.querySelector("div#person");
		person.style.display = "none";		// id ="person" 태그를 맨 처음에는 보이지 말아라.
		
		const select = document.querySelector("select#select");
		
		let html = `<option>선택하세요</option>`;
		
		arrMember.forEach( item => html += `<option>${item.name}</option>` ); 	// 반복해서 item 배열요소들 만큼 html에 누적시켜 불러오자.
		
		select.innerHTML = html;
		
		////////////////////////////////////////////////////////////////////////////////////
		
		const img = document.querySelector("img#img");
		const information = document.querySelector("div#information");
		
		// 값이 바뀌므로 (아이유 -> 김태희 -> 박보영) change 이벤트를 사용한다.
		// 즉, select 태그의 이벤트는 click 이 아니라 change 이다.		
		select.addEventListener('change', () => {
			// index 값을 찾아서 활용하자.
			
			const nSelectedIndex = select.selectedIndex;	// select 태그에서 0번 index
			// !!!! select.selectedIndex 은 <option>태그의 index 번호를 말한다. !!!!
	        // 즉, 첫번째 <option>태그는 0이고, 두번째 <option>태그는 1, 세번째 <option>태그는 2 ..... 으로 되어진다.
			
	       // alert(nSelectedIndex);	// 선택했을 때 index 가 몇번이냐.
			/*
	            <option>선택하세요</option>는 nSelectedIndex가 0
	            <option>아이유</option>는 nSelectedIndex가 1
	            <option>김태희</option>는 nSelectedIndex가 2
	            <option>박보영</option>는 nSelectedIndex가 3 이 된다. 
         	*/
         	
         	// 참고 : 배열명.forEach()는 break; 가 없으므로 배열명.forEach((item,index,array) => {} ) + break; 기능을 가지는 배열명.some( (item,index) => {} )을 사용한다. 
            //       배열명.some( (item,index) => { } )은 조건이 true가 되는 순간 반복을 멈추어 버린다.
         	arrMember.some((item, index) => {
         		/*
         			item 이 iyou_mbr 일 때, index 는 0이다.
         			item 이 kimth_mbr 일 때, index 는 1이다.
         			item 이 parkby_mbr 일 때, index 는 2이다.
                */
                
                if(nSelectedIndex == 0)	{// 0 은 '선택하세요' 이므로 아무 이미지, 정보를 보이면 안된다.
             		// <option>선택하세요</option>를 선택한 경우
             		person.style.display = "none";	// 선택한 처음에는 보이지말아라.
             	}
    	        else if(nSelectedIndex - 1 == index) {	// 0 이외의 것을 잡아왔을 때,  조건에 만족하면 그것만 보여주고 끝난다 (some) && 왜 -1을 썼는지? 위의 arrMember 배열의 index 와 맞추기 위해서.
    	        	img.src = `images/${item.photo}`;	// img 태그에 있는 속성값이 src(경로) 에 item.photo 를 넣어준다.
             	
    	        	html = `<ul>
		        				<li><label>성명</label>${item.name}<label></li>
		        				<li><label>생년</label>${item.getBirthYear}</li>	${''/*게터를 호출함. 주의사항 item.getBirthYear() 과 같이 하면 오류이다. */}
		        				<li><label>나이</label>${item.age()}세</li>
		        				<li><label>주소</label>${item.address}</li>
		        				<li><label>특이사항</label>${item.special}</li>
    	        			</ul>`;
    	        	
					information.innerHTML = html;		
    	        			
    	        //	person.style.display = "block";		// div 는 default 가 block 이다.
    	        	person.style.display = "";		
    	        }
                
         	} );// end of arrMember.some((item, index) => {...} )----------------------------
         	
  	
		});// end of select.addEventListener('change',...)------------------------------------------
		
	}
	
</script>

</head>
<body>

	<div id = "container">
		<h2>인물소개</h2>
		<select id="select"></select>
		<div id="person">
			<img id="img"/>
			<div id="information"></div>
		</div>
	</div>

</body>
</html>