<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>자바스크립트 정규 표현식을 사용하여 form 유효성 검사하기</title>

<style type="text/css">

	body {
		border: solid 0px gray;
		margin: 0;
		padding: 0;
		font-family: Arial, "MS Trebuchet", sans-serif;	
		word-break: break-all; 	/* 공백없이 영어로만 되어질 경우 해당구역을 빠져나가므로 이것을 막기위해서 사용한다. */
	}

	div#container {
		/* border: solid 1px gray; */
		width: 80%;
		margin: 0 auto; /* 균등분할 */
	}

	form {
		margin: 100px 0; 
	}

	legend {
		font-size: 20pt;
	}

	label.title {
		display : inline-block;	/*옆으로 가되 block 을 주어야 width 가 적용된다.*/
		width: 150px;
		color: navy;
		font-weight: bold;
	}

	ul {
		/*border : solid 1px red;*/
		list-style-type: none;
		padding-left: 0;
	}
	
	li {
		line-height: 40px; /* 줄간격 */
	}
	
	input.myinput {	/*input 태그인데 class 가 myinput 인 것*/
		height: 20px;
	}
	
	/* input[type="radio"]{	/*input 태그인데 type 이 radio 인 것*/
	/*		margin-right: 50px;	
	} */

	/*라디오 요소에 체크를 했을 경우 라디오 요소의 테두리를 오렌지색으로 주겠다.*/
	input[type="radio"]:checked	{		/*radio 에서 checked 된 곳에 orange색 box-shadow 로 덮어씌운다.*/
		box-shadow: 0 0 0 3px orange;
	}

	/*체크박스 요소에 체크를 했을 경우 체크박스 요소의 테두리를 빨간색으로 주겠다.*/	
	input[type="checkbox"]:checked	{	/*checkbox 에서 checked 된 곳에 red색 box-shadow 로 덮어씌운다.*/
		box-shadow: 0 0 0 3px red;
	}

	label[for="female"] { 		/*label 태그인데 속성값이 female 인 것 */
		padding-left: 50px;
	}
	
	select {	/*select 태그에 있는 것들 모두에 적용.*/
		width: 150px;
	}
	
	 select.myselect {	/*최종학력, 선호프로그램 부분만 변경하고자 myselect class로 묶어서 가져옴.*/
	 	height: 25px;
	 }
	
		
	
	input.btn {			/*input 인데 class 가 btn 인 것 (btn class 로 공통으로 묶임.)*/
		width: 100px;
		height: 50px;
		margin: 20px 0 0 40px;
		font-size: 14pt;
		cursor: pointer;
		color:  #fff;
		border: none;
		
		border-radius: 5%;	/*사각형을 깎아서 둥근 사각형으로 만들어 주는 것.*/
	}
	
	input[type="submit"] {	/*input 태그인데 속성이 submit 타입이다.*/
		background-color: #668cff;
	}
	
	input[type="reset"] {	/*input 태그인데 속성이 reset 타입이다.*/
		background-color: #9999ff;
	}	

	span.errmsg {
		font-size: 9pt;
		color: red;
		font-weight: bold;
	}

</style>

</head>
<body>
	<div id="container">		
		<!-- <form name="registerForm" action="register.do" method="post"> -->	<!-- 정보를 DB 로 보낼 때 form 태그를 사용한다. -->
		<!-- form 태그에서 method 를 지정하지 않으면 즉,생략하면 기본은 "GET"방식이다.
	      /*
	       form 태그에서 사용하는  method 는 2가지가 있는데 get 과 post 가 있다.
	       get 은 전송하고자 하는 데이터를 웹브라우저 주소창에 실어서 보내는 방식이고,
	       post 는 전송하고자 하는 데이터를 본문속에 감추어서 보내는 방식이다.
	       그래서 get 은 보안성이 떨어지는 반면에 속도는 post 보다 빠르다.
	       post는 보안성은 좋지만 속도는 get 보다는 느린편이다.
	       그러므로 외부에 공개해서는 안되는 작업인 회원가입, 물품구매, 회원수정 등 DML(insert, update, delete)작업은 
	       일반적으로 post 방식으로 하고, 
	       외부에 공개하더라도 전혀 무관한 데이터 검색(예: 물품조회, 게시판글 검색)인 select 작업은
	       일반적으로 get 방식으로 한다.
	       method 를 기재하지 않으면 get 방식이다. 
	       
	       !!! 또한 파일을 첨부하려면 반드시 method="post" 이어야만 한다. !!!
       	  */ -->
		<form name="registerForm" action="register.do" method="get">	<!-- 정보를 DB 로 보낼 때 form 태그를 사용한다. -->
			<!-- fieldset 태그는 form 을 그룹핑(묶어주는 것) 하는 역할이다. -->
			<fieldset>
			
				<!-- legend 태그는 fieldset 에 대한 제목을 지정한 것이다. -->
				<legend>회원가입 정보</legend>	
				
				<ul>	

					<li>
						<label for="userid" class="title">아이디</label>
						<input type="text" name="userid" id="userid" class="myinput" size="20" maxlength="20" autofocus required/>
						<span id="errUserid" class="errmsg"></span>
					</li>
					
					<li>
						<label for="passwd1" class="title">암호</label>
						<input type="password" name="passwd" id="passwd1" class="myinput" size="20" maxlength="20" required/>
						<span id="errPasswd" class="errmsg"></span>
					</li>
					
					<li>
						<label for="passwd2" class="title">암호확인</label>
						<input type="password" id="passwd2" class="myinput" size="20" maxlength="20" required/>					
						<span id="errPasswd2" class="errmsg"></span>
					</li>
					
					<li>
						<label for="name" class="title">성명</label>
						<input type="text" name="name" id="name" class="myinput" size="20" maxlength="20" required/>					
						<span id="errName" class="errmsg"></span>
					</li>
					
					<li>
						<label for="email" class="title">이메일</label>
						<input type="email" name="email" id="email" class="myinput" size="20" maxlength="40" required placeholder="예:hongkd@gmail.com"/>						
						<span id="errEmail" class="errmsg"></span>
					</li>
					
					<li>
						<label class="title">성별</label>
						<label for="male">남자</label><input type="radio" name="gender" id="male" value="male"/> 
						<label for="female">여자</label><input type="radio" name="gender" id="female" value="female"/>		
						&nbsp;&nbsp;<span id="errGender" class="errmsg"></span>
						<!-- radio 는 선택이 1개밖에 되지 않는다. -->				
					</li>
					
					<li>
						<label class="title">취미</label>
						<label for="hobby1">게임</label><input type="checkbox" name="hobby" id="hobby1" value="game" /> 
						<label for="hobby2">영화감상</label><input type="checkbox" name="hobby" id="hobby2" value="movie" /> 
						<label for="hobby3">글쓰기</label><input type="checkbox" name="hobby" id="hobby3" value="writing" /> 
						<label for="hobby4">음악감상</label><input type="checkbox" name="hobby" id="hobby4" value="music" />	
						&nbsp;&nbsp;<span id="errHobby" class="errmsg"></span>
						<!-- checkbox 는 복수개 선택이 가능하다. -->					
					</li>
					
					<li>
						<label class="title">출생년도</label>
						<select class="myselect" id="birthYear1" name="birthYear"></select>
						<span id="errBirthYear" class="errmsg"></span>
						<select class="myselect" id="birthYear2"></select>
						<select class="myselect" id="birthYear3"></select>
					</li>					
					
					<li>
						<label class="title">현재나이</label>
						<span id="age" style="font-size: 12pt; color: tomato;"></span>세
					</li>
					
					<li>
						<label class="title">최종학력</label>
						<select class="myselect" name="school">
							<option>최종학력</option>
							<option value="1">고졸</option>
							<option value="2">초대졸</option>
							<option value="3">대졸</option>
							<option value="4">대학원졸</option>
						</select>
						&nbsp;&nbsp;<span id="errSchool" class="errmsg"></span>
					</li>
					
					<li>
						<label class="title">선호음식</label>
						<select size="3" multiple name="food">	<!-- 몇개를 보일래? (size 개수 만큼) -->
							<option>짜장면</option>
							<option>파스타</option>
							<option>팟타이</option>
							<option>떡볶이</option>
							<option>치킨</option>
							<option>피자</option>
						</select>					
					</li>
					
					<li>
						<label class="title">선호프로그램</label>
						<select class="myselect" name="program">
							<optgroup label="DataBase">
								<option>ORACLE</option>
								<option>Mysql</option>
								<option>MSSQL</option>
							</optgroup>
							
							<optgroup label="Language">
								<option>C/C++</option>
								<option>PYTHON</option>
								<option>JAVA</option>
								<option>Spring</option>	
							</optgroup>
						</select>							
					</li>
					
					<li>
						<label for="browsername" class="title">웹브라우저</label>
						<input list="browserType" id="browsername" name="browsername" size="20" maxlength="20" required/>
						<datalist id="browserType">
							<option value="Chrome"/>
							<option value="Internet Explorer"/>
							<option value="Firexox"/>
							<option value="Opera"/>
							<option value="Safari"/>
						</datalist>							
					</li>
					
					<li>
						<label for="addfile" class="title">파일첨부</label>
						<input type="file" id="addfile"/>										
					</li>
					
					<li>
						<label for="registerComment" class="title">가입인사말</label>
						<textarea rows="5" cols="20" id="registerComment" placeholder="하고 싶은 말 쓰세요" name="registerComment"></textarea>		
						<span id="errRegisterComment" class="errmsg"></span>
						<!-- 가입인사말 칸을 5 줄에 20 칸 주겠다. -->						
					</li>
						
					<li>
						<input type="submit" value="확인" class="btn" />		<!-- submit 은 DB 로 전송 --> 
						<input type="reset" value="취소" class="btn" />		<!-- type 이 reset 이면 초기화. -->
					</li>					
							
				</ul>
				
			</fieldset>		
		</form>
	</div>

<script type="text/javascript">
	
	const now = new Date();					// 자바스크립트에서 현재날짜시각을 알려주는 것이다.
	const currentYear = now.getFullYear();	// 현재년도
	
	let sOption_1 = "<option>출생년도1</option>";
	for(let i=0; i<currentYear-1950+1; i++) {
		sOption_1 += "<option>"+(1950+i)+"</option>";
	}// end of for-------------------------------------------------------------

	document.querySelector("select#birthYear1").innerHTML = sOption_1; 
	
	let sOption_2 = "<option>출생년도2</option>";
	for(let i=0; i<currentYear-1950+1; i++) {
		sOption_2 += "<option>"+(1950+i)+"</option>";
	}// end of for-------------------------------------------------------------

	document.querySelector("select#birthYear2").innerHTML = sOption_2; 
	
	let sOption_3 = "<option>출생년도3</option>";
	for(let i=0; i<currentYear-1950+1; i++) {
		sOption_3 += "<option>"+(1950+i)+"</option>";
	}// end of for-------------------------------------------------------------
	
	document.querySelector("select#birthYear3").innerHTML = sOption_3; 

	///////////////////////////////////////////////////////////////////
	
	// 출생년도 구하기 ①
	const select1 = document.querySelector("select#birthYear1");	// 내가 선택한 출생년도 값
	
	select1.addEventListener("change", function() {
		
		const val = select1.value;
		
	//	console.log(isNaN(val));
		// NaN 은 Not a Number 로써
		/*
			isNaN(값); ==> 값이 숫자가 아니라면 true
			isNaN(값); ==> 값이 숫자라면 	   false			
		*/
		
		// 현재나이 구하기
		if(isNaN(val)) { // "출생년도1"을 선택한 경우.
			alert("태어나신 출생년도를 선택하세요.");
			document.querySelector("span#age").innerHTML = "";
		}
		else {	// 올바른 숫자년도를 선택한 경우.
			const age = currentYear - val + 1;
			document.querySelector("span#age").innerHTML = age;
		}

	});
	
	// 출생년도 구하기 ②	
	const select2 = document.querySelector("select#birthYear2");	// 내가 선택한 출생년도 값

	select2.onchange = function(){		// onchange 에서 대,소문자 유의 (onChange 가 아니다.)
		const val = select2.value;
		
		//	console.log(isNaN(val));
			// NaN 은 Not a Number 로써
			/*
				isNaN(값); ==> 값이 숫자가 아니라면 true
				isNaN(값); ==> 값이 숫자라면 	   false			
			*/
			
			// 현재나이 구하기
			if(isNaN(val)) { // "출생년도2"을 선택한 경우.
				alert("태어나신 출생년도를 선택하세요.");
				document.querySelector("span#age").innerHTML = "";
			}
			else {	// 올바른 숫자년도를 선택한 경우.
				const age = currentYear - val + 1;
				document.querySelector("span#age").innerHTML = age;
			}		
	}

	// 출생년도 구하기 ③
	const select3 = document.querySelector("select#birthYear3");	// 내가 선택한 출생년도 값

	select3.onchange = ()=>{		// onchange 에서 대,소문자 유의 (onChange 가 아니다.)
	
		const val = select3.value;
		
		//	console.log(isNaN(val));
			// NaN 은 Not a Number 로써
			/*
				isNaN(값); ==> 값이 숫자가 아니라면 true
				isNaN(값); ==> 값이 숫자라면 	   false			
			*/
			
			// 현재나이 구하기
			if(isNaN(val)) { // "출생년도3"을 선택한 경우.
				alert("태어나신 출생년도를 선택하세요.");
				document.querySelector("span#age").innerHTML = "";
			}
			else {	// 올바른 숫자년도를 선택한 경우.
				const age = currentYear - val + 1;
				document.querySelector("span#age").innerHTML = age;
			}		
	};
	
	//////////////////////////////////////////////////////////////////////////////
	
	// === submit 버튼을 클릭하면 해야할 일들을 기술하기 === //
	const frm = document.registerForm;	// 문서상에 name 태그가 registerForm 을 잡는 것이다.
	
	frm.onsubmit = () => {	// submit 되면 함수() 를 해라
	
		let isSubmit = true;
		
		// 1. 사용자 ID는 5글자 이상 20글자 이하 이어야 하고 첫글자는 영문대문자 이어야 하고 그 나머지는 영문자 또는 숫자로 이루어져야 한다. 
      	// 올바른예 : Superman , Batman007
      	// 틀린예: superman, Lees, Batman007$
      	
      	// === 정규표현식 객체 만들기 === //
      	// 정규표현식 객체는 항상 /로 시작해서 /로 끝나고, ; 을 붙여주면 된다.
      	let regExp = /^[A-Z][A-Za-z0-9]{4,19}$/;		// 첫글자는 영문 대문자로 시작한다. 영문대,소문자, 수는 4~19개 이상.
      	
      	// 위에서 생성한 정규표현식 객체에 데이터값을 넣어서 검사를 한다.
      	const bUserid = regExp.test(frm.userid.value);	// DB 에 보내주어야 하기 때문에 항상 name 이 있어야 한다. (submit 을 하려면 항상 name 이 있어야 한다. 여기서 아이디의 name 은 userid)
      	// frm.userid.value 값이 정규식표현 regExp 패턴에 맞으면 true, 틀리면 false
      	// return 타입이 항상 boolean 타입이다.
      	
      	if(!bUserid) {	// 정규식표현 regExp 패턴에 맞지 않으면!
      		
      		document.querySelector("span#errUserid").innerHTML = "아이디는 5글자~20글자 이어야 하고 첫글자는 영문대문자 나머지는 소문자 또는 숫자 이어야 합니다.";
      		frm.userid.value = "";
      		frm.userid.focus();			// false 면, 잘못 적엇던 id 를 ""로 만들고 자동 focus 맞춘다.
      		
      		isSubmit = false;
      	}
      	else {	// 정규표현식 패턴에 맞으면!
      		document.querySelector("span#errUserid").innerHTML = "";
        }
      	
     	// 2. 암호는 8글자 이상 15글자 이하이어야 하고, 영문자, 숫자, 특수문자가 혼합되어야만 한다.
        // 올바른예 : qwer1234$ , Abcd007!
        // 틀린예: qw12$ , qwer12345      	
        regExp = /^.*(?=^.{8,15}$)(?=.*\d)(?=.*[a-zA-Z])(?=.*[^a-zA-Z0-9]).*$/g;
        
     	const bPasswd = regExp.test(frm.passwd.value);
      	// frm.passwd.value 값이 정규식표현 regExp 패턴에 맞으면 true, 틀리면 false
     
     	if(!bPasswd) {	// 정규식표현 regExp 패턴에 맞지 않으면!
      		
      		document.querySelector("span#errPasswd").innerHTML = "비밀번호는 8글자 이상 15글자 이하이어야 하고, 영문자, 숫자, 특수문자가 혼합되어야 합니다.";
      		frm.passwd.value = "";
      		frm.passwd.focus();			// false 면, 잘못 적엇던 id 를 ""로 만들고 자동 focus 맞춘다.
      		
      		isSubmit = false;
      	}
      	else {	// 정규표현식 패턴에 맞으면!
      		document.querySelector("span#errPasswd").innerHTML = "";
        }     	
     	
      	// 3. 암호 입력란과 암호확인 입력란의 데이터가 동일한지 아닌지 검사하기
      	if(frm.passwd.value != document.querySelector("input[type=password]#passwd2").value) {
     
      		document.querySelector("span#errPasswd2").innerHTML = "비밀번호와 비밀번호 확인 값이 일치하지 않습니다.";
      		frm.passwd.value = "";	// 암호칸 공백으로 만들기
      		document.querySelector("input[type=password]#passwd2").value = "";	// 암호확인칸 공백으로 만들기
      		frm.passwd.focus();			// false 면, 잘못 적엇던 id 를 ""로 만들고 자동 focus 맞춘다.
      		
      		isSubmit = false;
      	}
      	else {	// 정규표현식 패턴에 맞으면!
      		document.querySelector("span#errPasswd2").innerHTML = "";
        }       	
      	
      	// 4. 성명은 공백만으로 이루어지면 안된다. 반드시 공백이 아닌 값을 입력해야 한다.      	
        regExp = /\s/g;		// /\s/g; : 공백으로만 이루어져 있는가
        
     	const bName = regExp.test(frm.name.value);
      	// frm.passwd.value 값이 정규식표현 regExp 패턴에 맞으면 true, 틀리면 false
     
     	if(bName) {	// 정규식표현 regExp 패턴에 맞지 않으면!
      		
      		document.querySelector("span#errName").innerHTML = "성명은 공백만으로 입력할 수 없습니다.";
      		frm.name.value = "";
      		frm.name.focus();			// false 면, 잘못 적엇던 id 를 ""로 만들고 자동 focus 맞춘다.
      		
      		isSubmit = false;	// 정규식표현에 맞지 않으면(공백이면), submit 하지 마라.
      	}
      	else {	// 정규표현식 패턴에 맞으면!
      		document.querySelector("span#errName").innerHTML = "";
        }        	
      	
     	// 5. 이메일은 필수 입력사항이므로 반드시 값을 입력해야 한다.
        // 올바른예 : leess@naver.com
        // 틀린예: leessnaver.com , leess@naver.@com
        
        regExp = /^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i; 
        
        const bEmail = regExp.test(frm.email.value);

     	if(!bEmail) {	// 정규식표현 regExp 패턴에 맞지 않으면!
      		
      		document.querySelector("span#errEmail").innerHTML = "올바르지 않은 이메일주소 입니다.";
      		frm.email.value = "";
      		frm.email.focus();			// false 면, 잘못 적엇던 id 를 ""로 만들고 자동 focus 맞춘다.
      		
      		isSubmit = false;	// 정규식표현에 맞지 않으면(공백이면), submit 하지 마라.
      	}
      	else {	// 정규표현식 패턴에 맞으면!
      		document.querySelector("span#errEmail").innerHTML = "";
        } 
      	
     	
      	// 6. 성별을 선택했는지 확인(radio 에서 선택했는지 확인)
      	const gender_list = document.querySelectorAll("input[name='gender']:checked")
      	
      	if(gender_list.length == 0) {	// check : 1
      		document.querySelector("span#errGender").innerHTML = "성별을 선택해야 합니다.";      	
      		isSubmit = false;
      	}
      	else {
      		document.querySelector("span#errGender").innerHTML = "";
      	}
      	

      	// 7. 취미는 최소 2개 이상 선택했는지 검사하기(체크박스에서 선택했는지 검사하기)
      	const hobby_list = document.querySelectorAll("input[name='hobby']:checked")
      	
      	if(hobby_list.length < 2) {	
      		document.querySelector("span#errHobby").innerHTML = "취미는 최소 2개 이상을 선택해야 합니다.";     	
      		isSubmit = false;
      	}
      	else {
      		document.querySelector("span#errHobby").innerHTML = "";
      	}      	
      	
      	
      	// 8. 출생년도를 선택했는지 검사하기
      	const birthYear = document.querySelector("select#birthYear1").value;	// value 값은 숫자로만 이루어져야 한다.(출생년도는 숫자만!!)
      	
      	if( isNaN(birthYear) ) {
      		// isNaN(birthYear) 는 birthYear 가 숫자로 되어있으면 true, 그렇지 않으면 false (Not a Number=NaN)
      		
      		document.querySelector("span#errBirthYear").innerHTML = "출생년도를 올바르게 선택하세요.";     	
      		isSubmit = false;		
      	}
      	else {
      		document.querySelector("span#errBirthYear").innerHTML = "";
      	}
      	
      	// 9. 최종학력을 선택했는지 검사하기
      	const school = document.querySelector("select[name='school']").value;

		if(school == "최종학력") {	// 최종학력을 설정하면 오류! (그외에 고,초대,대,대학원 졸만 선택해야 올바른 것.)
      		document.querySelector("span#errSchool").innerHTML = "최종학력을 올바르게 선택하세요.";     	
      		isSubmit = false;		
      	}
      	else {
      		document.querySelector("span#errSchool").innerHTML = "";
      	}
		
		
      	// 10. 가입인사말을 입력했는지 검사하기
   	    const registerComment = document.querySelector("textarea#registerComment").value;
      	
		if(registerComment.trim() == "") {	// 가입인사말이 공백일 때.
      		document.querySelector("span#errRegisterComment").innerHTML = "가입인사말은 공백만 입력이 불가합니다.";     	
      		isSubmit = false;		
      	}
      	else {
      		document.querySelector("span#errRegisterComment").innerHTML = "";
      	}      	
      	
      	
      	
     	if(!isSubmit) {
			return false;	// form 태그를 전송하지 말라는 의미.(submit 을 하지말라는 뜻이다.) 아이디, 암호가 제대로 입력되지 않았을 경우 전송하지 않는다.
     	}
      	
	};
	
	
</script>

</body>
</html>